---
description: 仕様が満たされるように実装するワークフロー
---

# Kotlin Specification Implementation Workflow

このワークフローは、固定された仕様とテストを満たす実装を作成し、品質を担保する手順を規定します。

## 1. 仕様とテストの再確認

実装に着手する前に、KDocの内容を精査してください。

- **仕様の整合性**: KDocに不足があったり、論理的な矛盾を発見した場合は、**即座にこのワークフローを中断**してください。
- **対応**: ユーザーに仕様の曖昧さや矛盾を報告し、仕様の修正（ステップ1および2の再実施）を求めてください。

## 2. 実装の作成

テストをパスさせるための最小限かつ堅牢な実装を行います。

- **バリデーション**: 関数の冒頭で、`require`, `check`, または `if (...) throw ...` を使用して、引数や状態の事前条件を検査してください。
    - バリデーションの条件と例外の型は、必ず KDoc の `@param` や `@throws` と一致させてください。
    - 例外の伝播や、throwする必要がある例外が実装段階で新たに判明した場合、実装を中止して、ユーザーに報告し、修正を求めてください。
- **仕様への忠実性**: KDocに記述された意味論を外れないように実装してください。
- **スタイルの遵守**:
    - 不必要な可変状態を排除してください。
    - 早期returnを活用し、ネストを平坦に保ってください。

## 3. Green（テスト成功）の確認

すべてのテストがパスすることを確認します。
テスト方法： `./gradlew check`

- 偶然通っていないか、アサーションの強さを確認してください。
- 例外テストについて、期待した条件以外で例外が投げられていないか注意してください。

## 4. レビュー

仕様（KDoc）、テスト、実装の三者が完全に一致していることを振り返ります。

- 実装の都合で仕様を曲げていないか確認してください。
- 可読性が高く、Kotlinらしい（Idiomatic な）コードになっているか確認してください。
